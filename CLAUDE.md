# 코드 규칙

1. typing library를 사용하지 말고 내장된 type을 활용. Ex) List, Dict (x), list, dict (o)
2. 주석은 왠만하면 달지 않습니다.
3. 요구한 것 외에 불필요한 매소드 추가, 테스트, 모니터링 등의 작업은 하지 않습니다.
4. 최대한 간단히 코드를 주세요.


# 터틀 트레이딩

## 터틀 트레이딩 매매 원칙 (오리지널)

### 용어
- **N**: ATR(20일) - Average True Range
- **유닛(Unit)**: 계좌의 1% 리스크에 해당하는 포지션 크기
  - 계산: (계좌 × 1%) / (N × 2)
  - 예: 1억원 계좌, 현재 주가 70,000, N=1,400원 → 1유닛 = 357주 (약 2,500만원)

### 1. 진입 (Entry)
- **System 1 (단기)**
  - 진입: 20일 최고가 돌파
  - **System 1 필터**: 
    - 마지막 System 1 거래가 수익으로 청산된 경우, 모든 System 1 신호 건너뜀
    - 마지막 System 1 거래가 손실로 청산된 경우, System 1 신호 진입 재개
- **System 2 (장기)**
  - 진입: 55일 최고가 돌파
  - 조건: 모든 돌파 신호에 진입
- **초기 포지션**: 1유닛

### 2. 추가 매수 (Pyramiding)
- **추가 조건**: 최근 진입가 대비 0.5N 상승 시마다 1유닛 추가
- **최대 제한**:
  - 단일 종목: 최대 4유닛
  - 관련 종목 그룹 (상관관계 0.7 이상): 최대 6유닛
  - 전체 롱(또는 숏): 최대 12유닛

### 3. 청산 (Exit)
#### 주 청산 방법 (Primary Exit)
- **System 1**: 10일 최저가 이탈 시 전량 청산
- **System 2**: 20일 최저가 이탈 시 전량 청산
#### 보조 청산 방법 (Secondary Exit - 비상용)
- **2N 손절**: 마지막 진입가 대비 2N 하락 시 전량 청산

### 4. 자금 관리 (Money Management)
- **계좌 레벨 조정**:
  - 계좌 10% 손실마다: 모든 유닛 리스크 20% 축소
    - 예: 1억 → 9천만원: 1유닛 리스크 100만원 → 80만원
  - 계좌 10% 회복마다: 모든 유닛 리스크 20% 확대
    - 단, 원래 설정(계좌의 1%)까지만


